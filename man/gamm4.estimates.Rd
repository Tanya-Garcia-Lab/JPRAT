% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/main.R
\name{gamm4.estimates}
\alias{gamm4.estimates}
\title{gamm4 Estimation}
\usage{
gamm4.estimates(
  arbitrary,
  num_study,
  np,
  count.store,
  count.store.outside,
  data,
  num_time,
  time_val,
  time_choice.predicted,
  time_choice.predicted.toadd,
  n,
  nmax,
  m,
  maxm,
  la,
  lb,
  xks,
  truth,
  num_xx,
  knot.length,
  real_data,
  family.data,
  zeval,
  z.choice,
  param.label,
  beta0int,
  gamma.param,
  omega.param,
  spline.constrain,
  common.param.estimation,
  est.cens.depend.z,
  par_fu,
  analyze.separately,
  link.type,
  null.theta,
  z.proportions
)
}
\arguments{
\item{arbitrary}{ADD DETAILS HERE!}

\item{num_study}{The number of studies used in analyses. If the real data analysis used three studies called "cohort", "predict", "pharos", then number of studies is 3. i.e., \code{num_study=3}.}

\item{np}{The number of clinical events, which is the length of the character vector for names of time-to-event outcomes (\code{event.outcome.names}) in \code{\link{jprat.wrapper}} function.}

\item{count.store}{A null object to store number of event times, which occurs before \eqn{t_0}.}

\item{count.store.outside}{A null object to store number of event times, which occurs before \eqn{t_0} for outside [0,1].}

\item{data}{A data set as starting values used for estimation procedure;
a list of starting values for binary event status (y_start), the missing indicator of the binary event status (ymiss_ind_start), the nonfunctional covariate Z (z_start),
the functional covariate X (x_start), the time-to-events or censoring times (s_start), the mixture probabilities for the jack-knife pseudo-values (q_start),
the censoring indicators (delta_start), the original onset ages (onset_age_orig_start), the indicator of no risk (norisk_ind_start), the counting numbers for the status of each event of interests (count),
the pseudo-values (ytest).}

\item{num_time}{A length of the vector of time points at which the predicted values of marginal distributions will be estimated.
See the argument \code{time.points.for.prediction} in the \code{\link{jprat.wrapper}} function.}

\item{time_val}{See the argument \code{time.points.for.prediction} in the \code{\link{jprat.wrapper}} function.}

\item{time_choice.predicted}{See the argument \code{time.points.for.conditional.prediction} in the \code{\link{jprat.wrapper}} function.}

\item{time_choice.predicted.toadd}{See the argument \code{time.points.for.conditional.prediction.toadd} in the \code{\link{jprat.wrapper}} function.}

\item{n}{A vector of the sample sizes for all studies.}

\item{nmax}{The maximum sample size across all studies.}

\item{m}{An array of the number of clinical events for each individual and per study,
whose dimension is the number of studies (\code{num_study})
by the maximum number of the sample sizes across studies (\code{nmax}).}

\item{maxm}{The maximum value of  the events across all subjects for all studies.}

\item{la}{A length of smooth functional parameters \eqn{\alpha(X,t)} in the model. The default value is 1 in the data analysis study.}

\item{lb}{A list of the number (dimension) for the coefficients of nonfunctional covariate Z (see the argument \code{functional.beta.coefficients}) per study.}

\item{xks}{A list of studies whose element of the list is the numeric vector of values for the functional covariates \eqn{X} in smooth functional parameter \eqn{\alpha(X, t)}.}

\item{truth}{A list of true model coefficients for "beta" (\eqn{\beta_{0}(t), \beta_{es}(t)}), "alphas" \eqn{\alpha(X,t)}, "Ft" (\eqn{F_{es}(t|X,Z)}), "Ft.predicted", "beta.diff", and "Ft.diff".}

\item{num_xx}{The number of functional covariate values \eqn{X} at which the functional parameters \eqn{\alpha(X, t)} are evaluated.}

\item{knot.length}{The number of knots used to construct the basis functions.}

\item{real_data}{A logical value whether the real data will be used. The default option is TRUE.}

\item{family.data}{A logical value if the clusters are families, where each member in the cluster is different.}

\item{zeval}{An array of the values of the nonfunctional covariate Z for all studies,
where the order of dimensions for this array is the number of studies (\code{num_study}),
the number of nonfunctional covariate \eqn{Z} (\code{z.choice}),
the length of the character vector for the names of time-to-event outcomes (\code{event.outcome.names})
and the number of coefficients of nonfunctional covariate Z (\code{functional.beta.coefficients}) per study.}

\item{z.choice}{The number of nonfunctional covariate \eqn{Z} used in the analysis.}

\item{param.label}{A character vector of the names for all coefficients of nonfunctional covariate Z in the model.}

\item{beta0int}{A fixed number for the intercept \eqn{\beta_0(t)} in the model. The default value is 0.25.}

\item{gamma.param}{A numeric vector of event specific coefficient, \eqn{\gamma_{e}(t)}. The default value is NULL.}

\item{omega.param}{A numeric vector of study specific coefficient, \eqn{\omega_s(t)}. The default value is NULL.}

\item{spline.constrain}{A logical value if B-spline is constrained at 0. To keep the design matrix correct, we need to have \eqn{B(0)=0}. The default option is TRUE.}

\item{common.param.estimation}{A logical value whether the model parameters are the same across studies: The default option is FALSE. See the argument \code{estimated.parameters.common.for.all.studies} in the \code{\link{jprat.wrapper}} function.}

\item{est.cens.depend.z}{A logical value whether the estimation process assumes that a censoring distribution depends on nonfunctional covariates \eqn{Z}.
If covariates Z does not follow a binomial distribution, then the default option is FALSE. See the argument \code{estimation.when.censoring.depends.on.z} in the \code{\link{jprat.wrapper}} function.}

\item{par_fu}{A vector of parameters for the normal distribution of random effect for all studies: "mean" and "sd".}

\item{analyze.separately}{A character value to determine whether analysis will be performed separately or jointly: the options are "studyevents" (studies and event), "studies", "events", or "none". See the argument \code{what.analyzed.separately} in the \code{\link{jprat.wrapper}} function.}

\item{link.type}{A character value for the name of the link function for the additive mixed effect model (the generalized linear model): "logit” for proportional odds model or "cloglog" for cox proportional hazards. See the argument \code{glm.link.type} in the \code{\link{jprat.wrapper}} function.}

\item{null.theta}{A list of all estimated parameters and coefficients ("beta", "alphas", "Ft" and ``Ft.predicted") in the model.
Each element of the list contains arrays of zeros at the specific time points, the values of covariates and the event of interest in each study,
whose dimension is determined by the length of studies, events, time points
where prediction occurs, and coefficients of the nonfunctional covariates.}

\item{z.proportions}{The marginal probability of the nonfunctional coavariate \eqn{Z}. The default value is NULL.}
}
\value{
A list of

\item{betaest}{A multi-dimensional array of the estimated functional coefficient \eqn{\beta(t)} (est), its estimated variance(Varest), estimated lower bounds(varlo) and upper bounds(varhi) of
               the confidence intervals at each time point for the event of interest per study.
              The dimensions of the array are the number of studies, the number of clinical events per study (np),
           the length of the vector of time points, the length of parameter label (i.e., beta0, beta1)
               and the length of the character vectors of estimates such as c("est", "varest", "varlo", "varhi").}
\item{alphasest}{A multi-dimensional array of the estimated smooth functional coefficient \eqn{\alpha(X,t)}
               (est), its estimated variances (varest), estimated lower bounds (varlo)
               and upper bounds (varhi) of the confidence intervals at specific value of x and each time point
               for the event of interest per study.
               The dimensions of the array are the number of studies,
               the number of clinical events per study, the length of the functional covariate values of X,
               the length of the vector of time points, the length of smooth functional parameters \eqn{\alpha(X,t)} (la)
               and the length of the character vectors of estimates such as c("est", "varest", "varlo", "varhi").}
\item{count.store}{See the return value of the \code{\link{jprat.main.estimates}} function.}
\item{count.store.outside}{See this return value of the \code{\link{jprat.main.estimates}} function.}
\item{Ftest}{A multi-dimensional array of the estimated monotone marginal distribution \eqn{F_{es}(t|X, Z)} (Ft) (est),
            estimated variances (varest), estimated lower bounds (varlo) and upper bounds (varhi) of the confidence intervals
            at the specific values of covariates Z and X and at each time point for the event of interest per study.
            The dimensions of the array are the number of studies, the number of clinical events per study, the length of nonfunctional covariate values Z,
            the length of functional covariate values X and
            the length of the character vectors of estimates such as c("est", "varest", "varlo", "varhi").}
\item{Ftest.predicted}{A multi-dimensional array of the predicted values for the monotonic marginal distribution \eqn{F_{es}(t|X, Z, t>t_0)} (Ft)
                      beyond time \eqn{t_0} at each time point for each event of interest per study.
                      The dimensions of the array are the number of studies (\code{num_study}),
                      the number of clinical events per study,
                      the length of nonfunctional covariate values Z,
                      the length of functional covariate values X,
                      the predicted time points (\code{time_choice.predicted.toadd}), the choice of time points for prediction
                      (\code{time_choice.predicted}), and the length of the name for the estimates (val="est", "varest", "varlo", "varhi").
                     This array exists if there exists some time points for the prediction (\code{time_choice.predicted}).}
\item{eflag}{an integer number to check errors while gamm4 estimation is processed. This value is 0 if there are no errors.}
}
\description{
This function returns the estimated jack-knife pseudo-values using the Kaplan-Meier estimator
and returns the estimated JPRAT parameters using the generalized additive mixed model (\code{\link{gamm4}}) in \code{\link{mgcv}}.
}
\details{
The estimates depend on whether analysis will be performed separately or jointly. See the argument \code{analyze.separately}
         \code{\link{jprat.main.estimates}}.  For the structure of the return values (betaest, alphaest, Ftest, and Ftest.predicted), see the return value \code{null.theta.est.ci}
         in the \code{\link{all_null_theta}} function.
}
\seealso{
jprat.main.estimates, all_null_theta
}
